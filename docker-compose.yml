services:
  tts-bot:
    build: .
    container_name: tts-bot
    privileged: true
    network_mode: host
    pid: host
    environment:
      - DATA_DIR=/root/projects/tts-bot/data
      - REDIS_URL=redis://localhost:6379/0
      - TMUX_SOCKET=/tmp/tmux-1001/default
      - OWNER_ID=7943234085
      - GEMINI_API_KEY=AIzaSyC5EqHvfu0SJOKrvkPz8vH3E7iFr9ZW1c8
      - MYSQL_HOST=localhost
      - MYSQL_USER=root
      - MYSQL_PASSWORD=${MYSQL_PASSWORD}
      - ROUTER_TOKEN=${ROUTER_TOKEN}
      - MYSQL_DATABASE=tts_bot
    volumes:
      - /tmp/tmux-1001:/tmp/tmux-1001
      - ~/.kiro:/root/.kiro
      - ~/personal:/root/personal
      - ~/workers:/root/workers
      - ~/projects:/root/projects
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:15001/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
